'use strict';
const assert = require('assert');
const path = require('path');
const utils = require('../lib/utils');
const copyfiles = require('../lib/copyfiles');
const installnodemodules = require('../lib/install_node_modules');

describe('install_node_modules (production)', function () {
  it('install production node_modules only', function (done) {
    const distpath = path.normalize(process.env.TMPDIR + 'dist/');
    copyfiles();
    installnodemodules();
    const awspkg = path.resolve(distpath, 'node_modules/aws-sdk/package.json');
    const pkg = require(awspkg);
    assert.strictEqual(pkg.name, 'aws-sdk');
    utils.deleteDirContents(distpath, true); // cleanup for next test
    done();
  });
});
